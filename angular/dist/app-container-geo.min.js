/*
 * app-container-geo
 * Version: 1.0.0 - 2017-01-31
 */
!function(a){function b(){var a=arguments[0],c=b.cache;return c[a]&&c.hasOwnProperty(a)||(c[a]=b.parse(a)),b.format.call(null,c[a],arguments)}function c(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function d(a,b){return Array(b+1).join(a)}var e={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};b.format=function(a,f){var g,h,i,j,k,l,m,n=1,o=a.length,p="",q=[],r=!0,s="";for(h=0;o>h;h++)if(p=c(a[h]),"string"===p)q[q.length]=a[h];else if("array"===p){if(j=a[h],j[2])for(g=f[n],i=0;i<j[2].length;i++){if(!g.hasOwnProperty(j[2][i]))throw new Error(b("[sprintf] property '%s' does not exist",j[2][i]));g=g[j[2][i]]}else g=j[1]?f[j[1]]:f[n++];if("function"==c(g)&&(g=g()),e.not_string.test(j[8])&&e.not_json.test(j[8])&&"number"!=c(g)&&isNaN(g))throw new TypeError(b("[sprintf] expecting number but found %s",c(g)));switch(e.number.test(j[8])&&(r=g>=0),j[8]){case"b":g=g.toString(2);break;case"c":g=String.fromCharCode(g);break;case"d":case"i":g=parseInt(g,10);break;case"j":g=JSON.stringify(g,null,j[6]?parseInt(j[6]):0);break;case"e":g=j[7]?g.toExponential(j[7]):g.toExponential();break;case"f":g=j[7]?parseFloat(g).toFixed(j[7]):parseFloat(g);break;case"g":g=j[7]?parseFloat(g).toPrecision(j[7]):parseFloat(g);break;case"o":g=g.toString(8);break;case"s":g=(g=String(g))&&j[7]?g.substring(0,j[7]):g;break;case"u":g>>>=0;break;case"x":g=g.toString(16);break;case"X":g=g.toString(16).toUpperCase()}e.json.test(j[8])?q[q.length]=g:(!e.number.test(j[8])||r&&!j[3]?s="":(s=r?"+":"-",g=g.toString().replace(e.sign,"")),l=j[4]?"0"===j[4]?"0":j[4].charAt(1):" ",m=j[6]-(s+g).length,k=j[6]&&m>0?d(l,m):"",q[q.length]=j[5]?s+g+k:"0"===l?s+k+g:k+s+g)}return q.join("")},b.cache={},b.parse=function(a){for(var b=a,c=[],d=[],f=0;b;){if(null!==(c=e.text.exec(b)))d[d.length]=c[0];else if(null!==(c=e.modulo.exec(b)))d[d.length]="%";else{if(null===(c=e.placeholder.exec(b)))throw new SyntaxError("[sprintf] unexpected placeholder");if(c[2]){f|=1;var g=[],h=c[2],i=[];if(null===(i=e.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(g[g.length]=i[1];""!==(h=h.substring(i[0].length));)if(null!==(i=e.key_access.exec(h)))g[g.length]=i[1];else{if(null===(i=e.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");g[g.length]=i[1]}c[2]=g}else f|=2;if(3===f)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");d[d.length]=c}b=b.substring(c[0].length)}return d};var f=function(a,c,d){return d=(c||[]).slice(0),d.splice(0,0,a),b.apply(null,d)};"undefined"!=typeof exports?(exports.sprintf=b,exports.vsprintf=f):(a.sprintf=b,a.vsprintf=f,"function"==typeof define&&define.amd&&define(function(){return{sprintf:b,vsprintf:f}}))}("undefined"==typeof window?this:window),function(a){function b(a){var b,d=a.split(",").map(function(a){return a.trim()}),e=d[0],f=d.slice(1),g=/(\[*?[^%]*?%[a-z0-9\.]+[^%]*?\]?)/g,h=[];c('fmt "%s"',e),c("keys = %s",f);for(var i;null!==(b=g.exec(e));)c("%j",b),h.push(b[1]),i=g.lastIndex;if(c("%d,%d",e.length,i),e.length>i&&(h[h.length-1]+=e.substring(i)),h=h.map(function(a){return/^\[.*\]$/.test(a)?{fmt:a.slice(1,a.length-1),opt:!0}:{fmt:a}}),h.forEach(function(a,b){c('[%d] = "%j"',b,a)}),h.length!==f.length)throw new Error("format to key length mismatch");this.$keys=f,this.$fmts=h}b.prototype.format=function(a){var b=this.$keys,e=this.$fmts,f=b.reduce(function(b,c,d){var f=a[c],g=null===f||"undefined"==typeof f,h=e[d];if(g&&!h.opt)throw new Error("missing required key "+c);return g||(b.fmt+=h.fmt,b.args.push(f)),b},{fmt:"",args:[]});return c("%j",f),d.apply(null,[f.fmt].concat(f.args))};var c,d;"undefined"!=typeof module&&module.exports?(module.exports=b,c=require("debug")("property-formatter"),d=require("sprintf-js").sprintf):"undefined"!=typeof a&&(a.PropertyFormatter=b,c=function(){},d=a.sprintf)}("undefined"==typeof window?this:window),angular.module("app-container-geo.admin",["app-container-file"]).directive("propertyFormatValidate",["$log","$q","$parse","$window",function(a,b,c,d){return{require:"ngModel",link:function(e,f,g,h){var i=d.PropertyFormatter,j=c(g.propertyFormatValidate)(e);a.debug("propertyFormatValidate.exampleProperties",j),j&&(h.$asyncValidators[g.ngModel.replace(".","_")+"_propertyFormat"]=function(c,d){a.debug('modelValue="'+c+'" newValue="'+d+'"');var e,f=b.defer();if(d)try{e=new i(d).format(j),a.debug("format string ok",e),f.resolve(!0)}catch(b){a.debug("format error",b),f.reject()}else f.reject();return f.promise})}}}]).directive("layerNameValidate",["$log","$q","$timeout","Layer",function(a,b,c,d){return{require:"ngModel",link:function(e,f,g,h){var i;h.$asyncValidators.layerNameinUse=function(e,f){a.debug('modelValue="'+e+'" newValue="'+f+'"'),i&&(c.cancel(i),i=void 0);var g=b.defer();return f?i=c(function(){d.query({$filter:"name eq '"+f+"'"},function(a){0===a.list.length?g.resolve(!0):g.reject()})},500):g.reject(),g.promise}}}}]).directive("layerCreateInputForm",[function(){return{restrict:"C",templateUrl:"js/admin/layer-create-input-form.html"}}]).directive("exampleLayerProperties",[function(){return{restrict:"AEC",template:'<h4>Example Feature Properties <i uib-popover-template="\'js/admin/layer-create-eprops-popover.html\'" popover-placement="auto bottom" class="fa fa-info-circle" aria-hidden="true"></i></h4><table class="table table-striped table-condensed"><tr><th>Property</th><th>Value</th><th>Type</th><th></th></tr><tr ng-repeat="(prop,pinfo) in preResults.examplePropertiesAnnotated"><td>{{prop}}</td><td>{{pinfo.value}}</td><td>{{pinfo.type}}</td><td><i uib-tooltip="Unique" ng-if="pinfo.unique" class="fa fa-key" aria-hidden="true"></i></td></tr></table>'}}]).controller("LayerCreateCtrl",["$scope","$log","$timeout","$uibModalInstance","WebSocketConnection","File","NotificationService",function(a,b,c,d,e,f,g){var h,i,j=a.STATES={HANDSHAKE:"HANDSHAKE",FILE_UPLOAD:"FILE_UPLOAD",PRE_PROCESS_RUNNING:"PRE_PROCESS_RUNNING",USER_INPUT:"USER_INPUT",COMPLETE:"COMPLETE"};a.infoMessages=[],a.dismiss=function(){function c(){d.dismiss()}a.uploadedFile?(b.debug("dismiss, cleaning up",a.uploadedFile),a.uploadedFile.$remove({id:a.uploadedFile._id},c,g.addError)):c()};var k=new e("geo/initLayer",function(){b.debug("connection to geo/initLayer established."),a.$on("$destroy",k.connectionCloser()),k.onMessage(function(c){a.$apply(function(){switch(b.debug("Message (current state:"+h+")",c),c.key){case"state":h=a.STATE=j[c.toState],i=a.STATE_DATA=c.data;break;case"error":b.error(c.data);break;case"info":b.debug("info: ",c.data),a.infoMessages.push(c.data);break;case"complete":break;default:b.error("unexpected message")}})}),c(function(){h=a.STATE=j.HANDSHAKE},1e3)});a.$watch("STATE",function(e){if(e)switch(b.debug("Entered state ",e),e){case j.HANDSHAKE:k.send({key:"state",currentState:j.HANDSHAKE});break;case j.USER_INPUT:a.preResults=i,a.userInput={};break;case j.COMPLETE:c(function(){d.close()},2e3)}}),a.fileResource=f,a.$watch("fileToUpload",function(b){console.log("fileToUpload",b),b&&b.file&&b.$save&&(b.metadata={type:"layerSource"},b.$save(function(b){a.uploadedFile=b,delete a.fileToUpload}))}),a.$watch("uploadedFile",function(c){c&&(b.debug("uploadedFile",c),"application/zip"!==c.contentType?(b.debug("File is not a zip, deleting."),g.addError({statusText:c.fileName+" is not a zip file."}),c.$remove({id:c._id},function(){b.debug("removed "+c.fileName),delete a.uploadedFile},g.addError)):(b.debug("Notifying server of new file, start pre-processing"),k.send({key:"state",currentState:h,data:c._id})))}),a.add=function(){k.send({key:"state",currentState:h,data:a.userInput})}}]).directive("layerAdmin",["$log","Layer","NotificationService","DialogService","$uibModal","PaneStateService",function(a,b,c,d,e,f){return{restrict:"E",templateUrl:"js/admin/layer-admin.html",scope:{},link:function(g,h,i){function j(){g.layers=b.query({})}g.isPaneActive=f.isActive,j(),g.createLayer=function(){e.open({templateUrl:"js/admin/layer-create.html",controller:"LayerCreateCtrl",windowClass:"layer-create",size:"lg",backdrop:"static",keyboard:!1}).result.then(function(){a.debug("layer creation dialog ok"),j()})},g.removeLayer=function(a){d.confirm({question:"Are you sure you want to delete "+a.name+"?",warning:"This cannot be undone."}).then(function(){a.$remove({id:a._id},function(){c.addInfo("Removed "+a.name),j()},c.addError)})}}}}]).directive("layerAdminMap",["$log","uiGmapGoogleMapApi","uiGmapIsReady","MapLayerService",function(a,b,c,d){return{restrict:"C",template:'<ui-gmap-google-map ng-if="map" center="map.center" zoom="map.zoom" options="map.options" events="map.events"><ui-gmap-marker ng-if="marker" coords="marker.coords" options="marker.options" events="marker.events" idkey="marker.id"></ui-gmap-marker></ui-gmap-google-map>',scope:{layer:"="},link:function(e,f,g){b.then(function(b){e.map={center:{latitude:41.13576,longitude:-99.157679},zoom:4,options:{scrollwheel:!1,streetViewControl:!1,mapTypeControl:!1,mapTypeId:b.MapTypeId.HYBRID,panControl:!1,zoomControl:!0,disableDoubleClickZoom:!0,zoomControlOptions:{style:b.ZoomControlStyle.SMALL,position:b.ControlPosition.RIGHT_TOP}}},c.promise(2).then(function(c){var f=c[1].map;f.data.addListener("mouseover",function(a){f.data.overrideStyle(a.feature,{strokeWeight:3})}),f.data.addListener("mouseout",function(a){f.data.revertStyle()}),f.data.addListener("click",function(b){e.$apply(function(){a.debug("feature click.")})}),b.event.trigger(f,"resize"),d.getForLayer(e.layer).then(function(a){a.map(f).add()})})})}}}]),angular.module("app-container-geo",["app-container-common","templates-app-container-geo","app-container-geo.admin"]).service("Layer",["$appService",function(a){var b=a("geo/layer/:id");return b}]).service("Feature",["$appService",function(a){var b=a("geo/feature/:id");return b}]).factory("MapLayerService",["$q","MapLayer","Feature",function(a,b,c){return{getForPoint:function(d,e){var f=a.defer();return c.get({id:"containingPoint",lat:d,lon:e},function(a){f.resolve(new b(a.list))}),f.promise},getForFeature:function(d){var e=a.defer();return c.get({id:d},function(a){e.resolve(new b([a]))}),e.promise},getForLayer:function(d){var e=a.defer(),f="string"==typeof d?d:d&&d._id?d._id:void 0;return f?c.query({$filter:"_layer eq '"+f+"'",$top:5e3},function(a){e.resolve(new b(a.list))}):e.reject("bad layerOrId"),e.promise}}}]).factory("MapLayer",["$log","Layer","Feature",function(a,b,c){var d=d3.scaleOrdinal(d3.schemeCategory20),e={strokeColor:"#ffffff",strokeOpacity:null,strokeWeight:1,fillColor:"#aaaaaa",fillOpacity:null,zIndex:0,clickable:!0},f=function(a,b){this.$feature=a,this.$layer=b,this.$isOn=!0;var c=this,d=this.$properties={};a.forEachProperty(function(a,b){d[b]=a}),a.getMapFeature=function(){return c}},g=function(a){(this.$features=a||[]).forEach(function(a){var b=a.data.properties;b.$featureName=a.featureName,b.$layerName=a._layer.name,b.$layerId=a._layer._id,b.$featureId=a._id})};return f.prototype.getBounds=function(){if(!this.$bounds){var a=this.$bounds=new google.maps.LatLngBounds,b=this.$feature.getGeometry(),c=b.getType();if(c&&/Polygon/.test(c)){var d,e,f=b.getArray(),g="Polygon"===c?f:f.reduce(function(a,b){return a.push(b.getArray()[0]),a},[]);for(d=0;d<g.length;d++){var h=g[d].getArray();for(e=0;e<h.length;e++)a.extend(new google.maps.LatLng(h[e].lat(),h[e].lng()))}}}return this.$bounds},f.prototype.$area=function(){var a=this.getBounds(),b=a.getNorthEast(),c=a.getSouthWest();return Math.abs(b.lat()-c.lat())*Math.abs(b.lng()-c.lng())},f.prototype.fit=function(){this.$layer.map().fitBounds(this.getBounds())},f.prototype.on=function(){this.$isOn||(this.$layer.map().data.add(this.$feature),this.$isOn=!0)},f.prototype.off=function(){this.$isOn&&(this.$layer.map().data.remove(this.$feature),this.$isOn=!1)},f.prototype.isOn=function(){return this.$isOn},f.prototype.toggle=function(){return this[this.isOn()?"off":"on"](),this.isOn()},f.prototype.properties=function(){return this.$properties},f.prototype.name=function(){return this.$properties.$featureName},f.prototype.id=function(){return this.$properties.$featureId},f.prototype.layerId=function(){return this.$properties.$layerId},f.prototype.layerName=function(){return this.$properties.$layerName},f.prototype.getFeatureResource=function(){var a=this;return a.$featureResource||(a.$featureResource=c.get({id:a.id()}),a.$featureResource.$promise.then(function(b){b.getMapFeature=function(){return a}})),a.$featureResource.$promise},f.prototype.getLayerResource=function(){var a=this;return a.$layerResource||(a.$layerResource=b.get({id:a.layerId()}),a.$layerResource.$promise.then(function(b){b.getMapFeature=function(){return a}})),a.$layerResource.$promise},g.prototype.map=function(a){return arguments.length?(this.$map=a,this):this.$map},g.prototype.geoJson=function(){return{type:"FeatureCollection",features:this.$features.map(function(a){return a.data})}},g.prototype.add=function(){var b,c=this,g=c.map();return g&&!c.$mapFeatures&&(b=g.data.addGeoJson(c.geoJson()),c.$mapFeatures=b.map(function(a,b){return a.setProperty("$style",angular.extend({},e,{fillColor:d(b)})),new f(a,c)}),c.$mapFeatures.sort(function(a,b){return b.$area()-a.$area()}),c.$mapFeatures.forEach(function(a,b){var c=a.$feature.getProperty("$style");c.zIndex=b}),a.debug("feature stacking order",c.$mapFeatures.reduce(function(a,b){return a.push(b.layerName()+" : "+b.name()),a},[]).join(",")),g.data.setStyle(function(a){return a.getProperty("$style")})),c},g.prototype.fit=function(){return this.$mapFeatures&&this.$mapFeatures.length&&this.$mapFeatures[0].fit(),this},g.prototype.features=function(){return this.$mapFeatures||[]},g.prototype.remove=function(){return this.features().forEach(function(a){a.off()}),this},g}]),angular.module("templates-app-container-geo",["js/admin/layer-admin.html","js/admin/layer-create-eprops-popover.html","js/admin/layer-create-idfmt-popover.html","js/admin/layer-create-input-form.html","js/admin/layer-create-lname-popover.html","js/admin/layer-create-lsource-popover.html","js/admin/layer-create-nmfmt-popover.html","js/admin/layer-create.html"]),angular.module("js/admin/layer-admin.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-admin.html",'<pane-set unique-id="layer-admin" open-heading-cols="4">\n    <pane-set-header>\n        <div class="pane-set-title" title="Layer Administration"></div>\n    </pane-set-header>\n    <pane-set-footer>\n        <button class="btn btn-default pull-right" ng-click="createLayer()">New Layer</button>\n    </pane-set-footer>\n\n    <pane ng-repeat="l in layers.list" unique-id="pane-{{l._id}}">\n        <pane-heading>\n            <h4>{{l.name}}</h4>\n            <div class="file-info" file="l._sourceFile"></div>\n            <a href ng-click="removeLayer(l)">Remove layer</a>\n        </pane-heading>\n        <div ng-if="isPaneActive(\'pane-\'+l._id)">\n            <div class="layer-admin-map" layer="l" />\n        </div>\n    </pane>\n</pane-set>\n')}]),angular.module("js/admin/layer-create-eprops-popover.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create-eprops-popover.html",'<div>\n    <p>The properties below represent the superset of all available properties\n        across all features within your new layer.  Displayed values are pulled\n        from first feature to have the given property set.</p>\n\n    <p>Properties flagged with the <i class="fa fa-key" aria-hidden="true"></i>\n        icon have values that are unique across all features within your new layer.</p>\n\n    <p>If a property has an explicit type (e.g. <code>string</code>,<code>number</code>\n        or <code>boolean</code>) then this indicates the property is available\n        on all features and has a consistent type across them.</p>\n\n    <p>A property type of <code>mixed</code> almost certainly indicates that\n        property in question is either unset or is <code>null</code>\n        for some features.</p>\n</div>\n')}]),angular.module("js/admin/layer-create-idfmt-popover.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create-idfmt-popover.html","<div>\n    <p>Each feature added to the system must have an id that identifies it uniquely\n        within its layer.</p>\n    <p>If this layer is updated in the future (e.g. boundaries re-defined) it may be\n        desireable to allow the feature data to be updated in place rather than\n        recreated.  For example if other entities are to be associated with a given feature\n        to prevent data integrity problems.</p>\n    <p>The property format syntax is basic <code>sprintf</code> format without\n        surrounding <code>&quot;</code> characters.  Unlike standard <code>sprintf</code>\n        you can wrap optional properties in <code>[]</code>.</p>\n    <p><em>Example:</em> If your features had a unique property, <code>GEOID</code> that\n        is guaranteed to remain constant moving forward you could specify a format\n        like <code>%s,GEOID</code>.</p>\n    <p><em>Example:</em> If your features had two properties then when put together\n        would guarantee uniqueness, and remain constant moving forward, you could\n        specify a format like <code>%s.%s,MAINID,SUBID</code>.</p>\n</div>\n")}]),angular.module("js/admin/layer-create-input-form.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create-input-form.html",'<form name="newLayerForm" ng-if="userInput && preResults">\n    <div class="form-group">\n        <label for="inputFile">Source File</label>\n        <div id="inputFile" class="file-info" file="uploadedFile"></div>\n    </div>\n    <div class="form-group">\n        <div class="text-danger pull-right" ng-if="newLayerForm.$error.layerNameinUse.length">\n            The layer name &quot;{{newLayerForm.$error.layerNameinUse[0].$viewValue}}&quot; is already in use.\n        </div>\n        <label for="layerName">Layer Name <i uib-popover-template="\'js/admin/layer-create-lname-popover.html\'" popover-placement="auto right" class="fa fa-info-circle" aria-hidden="true"></i> *</label>\n        <input id="layerName" type="text" class="form-control"\n               ng-model="userInput.layerName" layer-name-validate required />\n    </div>\n    <div class="form-group">\n        <div class="text-danger pull-right" ng-if="newLayerForm.$error.userInput_featureIdFmt_propertyFormat.length">\n            Invalid format\n        </div>\n        <label for="featureIdFmt">Feature Id Format <i uib-popover-template="\'js/admin/layer-create-idfmt-popover.html\'" popover-placement="auto right" class="fa fa-info-circle" aria-hidden="true"></i> *</label>\n        <input id="featureIdFmt" type="text" class="form-control"\n               ng-model="userInput.featureIdFmt"\n               property-format-validate="preResults.exampleProperties" required />\n    </div>\n    <div class="form-group">\n        <div class="text-danger pull-right" ng-if="newLayerForm.$error.userInput_featureNameFmt_propertyFormat.length">\n            Invalid format\n        </div>\n        <label for="featureNameFmt">Feature Name Format <i uib-popover-template="\'js/admin/layer-create-nmfmt-popover.html\'" popover-placement="auto right" class="fa fa-info-circle" aria-hidden="true"></i> *</label>\n        <input id="featureNameFmt" type="text" class="form-control"\n               ng-model="userInput.featureNameFmt"\n               property-format-validate="preResults.exampleProperties" required />\n    </div>\n    <div class="form-group">\n        <label for="layerSource">Layer Source <i uib-popover-template="\'js/admin/layer-create-lsource-popover.html\'" popover-placement="auto right" class="fa fa-info-circle" aria-hidden="true"></i> </label>\n        <input id="layerSource" type="url" class="form-control"\n               ng-model="userInput.layerSource" />\n    </div>\n    <ul class="list-inline pull-right">\n        <li><button class="btn btn-default" ng-click="dismiss()">Cancel</button></li>\n        <li><button class="btn btn-default" ng-click="add()" ng-disabled="newLayerForm.$invalid">Create</button></li>\n    </ul>\n</form>\n')}]),angular.module("js/admin/layer-create-lname-popover.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create-lname-popover.html","<div>\n    Specify your layer name here.  Your layer name must be unique within the system.\n</div>\n")}]),angular.module("js/admin/layer-create-lsource-popover.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create-lsource-popover.html","<div>\n    <p>It may be useful to keep track of where the source of this layer originated.\n    If you downloaded the data from a web address you can record that here.</p>\n</div>\n")}]),angular.module("js/admin/layer-create-nmfmt-popover.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create-nmfmt-popover.html","<div>\n    <p>Each feature added to the system should have a friendly name to identify it.\n        Feature names are generated from each feature's properties.</p>\n    <p>The property format syntax is basic <code>sprintf</code> format without\n        surrounding <code>&quot;</code> characters.  Unlike standard <code>sprintf</code>\n        you can wrap optional properties in <code>[]</code>.</p>\n    <p><em>Example:</em> If your features had a unique property, <code>UNITNAME</code> that\n        is guaranteed to remain constant moving forward you could specify a format\n        like <code>%s,UNITNAME</code>.</p>\n    <p><em>Example:</em> If your features had two properties then when put together\n        would create a more meaningful feature name, but one of the two properties\n        is not always available (not unique, type <code>mixed</code>), you might\n        specify a format like <code>%s[ (%s)],UNITNAME,SUBUNITNAME</code>.</p>\n</div>\n")}]),angular.module("js/admin/layer-create.html",[]).run(["$templateCache",function(a){a.put("js/admin/layer-create.html",'<div class="clearfix modal-header">\n    <ul class="list-inline pull-right">\n        <li class="spinner" is-working="!STATE || [STATE.FILE_UPLOAD,STATE.USER_INPUT].indexOf(STATE) !== -1"></li>\n        <li><a href class="pull-right" ng-click="dismiss()"><i class="fa fa-times-circle-o fa-2x"></i></a></li>\n    </ul>\n\n    <h2>Add Layer</h2>\n</div>\n<div class="clearfix modal-body">\n    <p ng-if="!STATE">Waiting to establish connection...</p>\n\n    <div ng-show="STATE === STATES.FILE_UPLOAD">\n        <p>Start by uploading the source of your layer (currently only zipped shapfile).</p>\n        <input type="file" file-model="fileToUpload" file-resource="fileResource" />\n    </div>\n\n    <div ng-show="STATE === STATES.USER_INPUT">\n        <p>Your new layer will have <mark>{{preResults.featureCount}}</mark> features (assuming they can all\n            be successfully indexed).</p>\n        <div class="layer-create-input-form clearfix"></div>\n        <div class="example-layer-properties"></div>\n    </div>\n\n    <div ng-if="STATE === STATES.COMPLETE && userInput">\n        Layer {{userInput.layerName}} added.\n    </div>\n</div>\n')}]);