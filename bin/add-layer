#!/usr/bin/env node
var argv = require('minimist')(process.argv.slice(2)),
    layerImport = require('../layer-import'),
    PreProcessorFactory = layerImport.PreProcessorFactory;

function usage() {
    console.error('add-layer -f <shapeFile>');
    process.exit(1);
}

if(!argv.f) {
    console.error('missing required parameter.');
    usage();
}

var preProcess = PreProcessorFactory(argv.f);
preProcess.on('error',function(err) {
    console.error('preProcess error:',err);
    process.exit(1);
})
.on('complete',function(results) {
    console.log('COMPLETE');
    console.dir(preProcess.results());
    if(!argv.nocleanup) {
        preProcess.cleanup(function(err){
            if(err) {
                console.error(err);
            }
            process.exit(err ? 1 :0);
        });
    }
});
preProcess.start();
